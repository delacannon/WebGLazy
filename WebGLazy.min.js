!function(t,e){for(var i in e)t[i]=e[i]}(window,function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function s(t){if(!s.context&&(s.context=t.getContext("webgl")||t.getContext("experimental-webgl"),!s.context))throw"No WebGL support";return s.context}function WebGLazy(t){this.options=t||{},this.sources=this.options.sources||["canvas","video","img"],this.source=this.options.source||this.getSource(),this.hideSource=void 0===this.options.hideSource||this.options.hideSource,this.background=this.options.background||"black",this.scaleMultiplier=this.options.scaleMultiplier||1,this.scaleMode=void 0!==this.options.scaleMode?this.options.scaleMode:this.constructor.SCALE_MODES.FIT,this.allowDownscaling=this.options.allowDownscaling||!1,this.timestep=this.options.timestep||1/60*1e3,this.disableFeedbackTexture=!!this.options.disableFeedbackTexture,this.disableMouseEvents=!!this.options.disableMouseEvents,(void 0===this.options.autoInit||this.options.autoInit)&&this.init()}i.r(e),i.d(e,"WebGLazy",function(){return WebGLazy}),s.Shader=function(t,e){this.gl=new s,this.vertSource=t,this.fragSource=e,this.program=this.gl.createProgram();try{this.vertShader=this.compileShader(this.vertSource,this.gl.VERTEX_SHADER),this.fragShader=this.compileShader(this.fragSource,this.gl.FRAGMENT_SHADER)}catch(t){throw this.gl.deleteProgram(this.program),delete this.program,console.error("Couldn't create shader: ",t),t}this.gl.attachShader(this.program,this.vertShader),this.gl.deleteShader(this.vertShader),delete this.vertShader,this.gl.attachShader(this.program,this.fragShader),this.gl.deleteShader(this.fragShader),delete this.fragShader,this.gl.linkProgram(this.program)},s.Shader.prototype.compileShader=function(t,e){try{var i=this.gl.createShader(e);if(this.gl.shaderSource(i,t),this.gl.compileShader(i),!this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS))throw this.gl.getShaderInfoLog(i);return i}catch(i){throw console.error("Couldn't compile shader ("+e+"): ",t,i),i}},s.Shader.prototype.useProgram=function(){this.gl.useProgram(this.program)},s.Texture=function(t,e){this.gl=new s,this.source=t,this.texture=this.gl.createTexture(),this.bind(e),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.source),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.bindTexture(this.gl.TEXTURE_2D,null)},s.Texture.prototype.update=function(){this.bind(),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.source),this.gl.bindTexture(this.gl.TEXTURE_2D,null)},s.Texture.prototype.bind=function(t){var e=t||this.lastBoundId||0;this.gl.activeTexture(this.gl.TEXTURE0+e),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.lastBoundId=e},WebGLazy.SCALE_MODES=Object.freeze({FIT:"FIT",COVER:"COVER",MULTIPLES:"MULTIPLES",NONE:"NONE"}),WebGLazy.prototype.getSource=function(){var t,e=[];for(t=0;t<this.sources.length;++t)e.push(Array.prototype.slice.call(document.getElementsByTagName(this.sources[t])));if(0===(e=Array.prototype.concat.apply([],e)).length)throw"Couldn't find an element from "+this.sources+" to use as a source";return e[0]},WebGLazy.prototype.insertStylesheet=function(){this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML=["html,body,div#canvasContainer{","    padding:0;","    margin:0;","","    width:100%;","    height:100%;","","    top:0;","    left:0;","    right:0;","    bottom:0;","","    background: "+this.background+";","    color:#FFFFFF;","","    overflow:hidden;","","    /*cursor:none;*/",this.hideSource?"    visibility: hidden!important;":"","}","","canvas#outputCanvas{","    image-rendering: optimizeSpeed;","    image-rendering: -webkit-crisp-edges;","    image-rendering: -moz-crisp-edges;","    image-rendering: -o-crisp-edges; ","    image-rendering: crisp-edges;","    image-rendering: -webkit-optimize-contrast;","    image-rendering: optimize-contrast;","    image-rendering: pixelated;","    -ms-interpolation-mode: nearest-neighbor;","","    position:absolute;","    margin:auto;","    top:0;","    left:-1000%;","    right:-1000%;","    bottom:0;","",this.hideSource?" visibility: visible!important;":"",this.scaleMode===this.constructor.SCALE_MODES.MULTIPLES?["    transition:","        width  0.2s cubic-bezier(0.22, 1.84, 0.88, 0.77),","        height 0.2s cubic-bezier(0.22, 1.84, 0.88, 0.77);"].join("\n"):"","};"].join("\n")},WebGLazy.prototype.init=function(){this.size={x:this.source.width||this.source.style.width,y:this.source.height||this.source.style.height},this.size.x*=this.scaleMultiplier||1,this.size.y*=this.scaleMultiplier||1,this.ratio=this.size.x/this.size.y,this.insertStylesheet(),this.canvasContainer=document.createElement("div"),this.canvasContainer.id="canvasContainer",this.allowDownscaling||(this.canvasContainer.style.minWidth=this.size.x+"px",this.canvasContainer.style.minHeight=this.size.y+"px"),this.canvas=document.createElement("canvas"),this.canvas.id="outputCanvas",this.canvas.width=this.size.x,this.canvas.height=this.size.y,this.canvas.style.width=this.canvas.style.height=0,this.canvasContainer.appendChild(this.canvas),document.body.appendChild(this.canvasContainer);try{this.gl=new s(this.canvas),this.render=this.renderGL}catch(t){console.warn("Falling back to canvas rendering: ",t),this.render=this.renderCanvas,this.canvas2d=this.canvas.getContext("2d")}if(this.gl){var t,e,i=document.getElementById("shader-vert"),o=document.getElementById("shader-frag");i&&(t=i.innerHTML),o&&(e=o.innerHTML),t=t||["// default vertex shader","attribute vec4 position;","void main() {","    gl_Position = position;","}"].join("\n"),e=e||["// default fragment shader","precision mediump float;","uniform sampler2D tex0;","uniform sampler2D tex1;","uniform vec2 resolution;","","void main() {","    vec2 coord = gl_FragCoord.xy;","    vec2 uv = coord.xy / resolution.xy;","    gl_FragColor = vec4(texture2D(tex0, uv).rgb, 1.0);","}"].join("\n"),this.shader=new s.Shader(t,e),this.vertices=new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),this.vertexBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.textureSource=new s.Texture(this.source,0),this.disableFeedbackTexture||(this.textureFeedback=new s.Texture(this.canvas,1)),this.glLocations={position:this.gl.getAttribLocation(this.shader.program,"position"),tex0:this.gl.getUniformLocation(this.shader.program,"tex0"),tex1:this.gl.getUniformLocation(this.shader.program,"tex1"),time:this.gl.getUniformLocation(this.shader.program,"time"),resolution:this.gl.getUniformLocation(this.shader.program,"resolution")},this.gl.enableVertexAttribArray(this.glLocations.position),this.gl.viewport(0,0,this.size.x,this.size.y),this.shader.useProgram(),this.gl.vertexAttribPointer(this.glLocations.position,2,this.gl.FLOAT,!1,0,0),this.gl.clearColor(0,0,0,1),this.gl.uniform1i(this.glLocations.tex0,0),this.gl.uniform1i(this.glLocations.tex1,1),this.gl.uniform2f(this.glLocations.resolution,this.size.x,this.size.y)}window.onresize=this.onResize.bind(this),window.onresize(),this.disableMouseEvents||(this.canvas.onmousedown=this.onMouseEvent.bind(this),this.canvas.onmouseup=this.onMouseEvent.bind(this),this.canvas.onmousemove=this.onMouseEvent.bind(this),this.canvas.onmouseenter=this.onMouseEvent.bind(this),this.canvas.onmouseexit=this.onMouseEvent.bind(this),this.canvas.onmouseover=this.onMouseEvent.bind(this),this.canvas.onmouseout=this.onMouseEvent.bind(this),this.canvas.onmouseleave=this.onMouseEvent.bind(this),this.canvas.onclick=this.onMouseEvent.bind(this),this.canvas.ondblclick=this.onMouseEvent.bind(this),this.canvas.oncontextmenu=this.onMouseEvent.bind(this)),this.accumulator=0,"performance"in window?this.now=function(){return window.performance.now()}:this.now=function(){return window.Date.now()},"requestAnimationFrame"in window?this.requestAnimationFrame=function(t){window.requestAnimationFrame(t)}:this.requestAnimationFrame=function(t){setTimeout(t,-1)},this.startTime=this.now(),this.curTime=this.lastTime=0,this.main=this.main.bind(this),this.main(this.curTime)},WebGLazy.prototype.main=function(t){this.lastTime=this.curTime,this.curTime=(t||this.now())-this.startTime,this.deltaTime=this.curTime-this.lastTime,this.accumulator+=this.deltaTime,this.accumulator>this.timestep&&(this.render(),this.accumulator-=this.timestep),this.requestAnimationFrame(this.main)},WebGLazy.prototype.renderCanvas=function(){this.canvas2d.clearRect(0,0,this.size.x,this.size.y),this.canvas2d.drawImage(this.source,0,0)},WebGLazy.prototype.renderGL=function(){this.textureSource.update(),this.gl.uniform1f(this.glLocations.time,this.curTime),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.shader.useProgram(),this.textureSource.bind(),this.disableFeedbackTexture||this.textureFeedback.bind(),this.gl.drawArrays(this.gl.TRIANGLES,0,this.vertices.length/2),this.disableFeedbackTexture||this.textureFeedback.update()},WebGLazy.prototype.onResize=function(){var t,e,i=this.canvasContainer.offsetWidth,s=this.canvasContainer.offsetHeight,o=i/s,r=this.constructor.SCALE_MODES,n=1;switch(o<this.ratio?s=Math.round(i/this.ratio):i=Math.round(s*this.ratio),this.scaleMode){case r.MULTIPLES:for(n=1,t=this.size.x,e=this.size.y;t+this.size.x<=i||e+this.size.y<=s;)t+=this.size.x,e+=this.size.y,n+=1;break;case r.FIT:t=i,e=s,n=i/this.size.x;break;case r.COVER:i=this.canvasContainer.offsetWidth,s=this.canvasContainer.offsetHeight,o<this.ratio?i=Math.round(s*this.ratio):s=Math.round(i/this.ratio),t=i,e=s,n=i/this.size.x;break;case r.NONE:n=1,t=this.size.x,e=this.size.y}this.scaleMultiplier=this.scaleMultiplier*n,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"},WebGLazy.prototype.onMouseEvent=function(t){var e=this.canvas,i=this.source,s=e.offsetLeft+e.scrollLeft,o=e.offsetTop+e.scrollTop,r=i.offsetLeft+i.scrollLeft,n=i.offsetTop+i.scrollTop,h=1/this.scaleMultiplier,a=document.createEvent("MouseEvent");a.initMouseEvent(t.type,t.bubbles,t.cancelable,t.view,t.detail,(t.screenX-s)*h+r,(t.screenY-o)*h+n,(t.clientX-s)*h+r,(t.clientY-o)*h+n,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),i.dispatchEvent(a)}}]));